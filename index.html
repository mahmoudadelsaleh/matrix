<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Matrix Pro - M.A.S</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root { --p: #2c3e50; --a: #2980b9; --ac: #fff9c4; --s: #27ae60; --w: #e67e22; --gold: #ffd700; --random: #8e44ad; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        
        /* ØªØ¬Ù…ÙŠØ¯ Ø§Ù„Ø´Ø§Ø´Ø© ÙˆØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø¨Ø¯Ù‚Ø© */
        html, body { height: 100vh; width: 100vw; overflow: hidden; background: #f4f7f6; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; }

        /* Ø§Ù„Ù‚Ø³Ù… 1: Ø§Ù„Ù…ØµÙÙˆÙØ§Øª - Ù…Ù„ØªØµÙ‚ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ (24% Ù…Ù† Ø§Ù„Ø§Ø±ØªÙØ§Ø¹) */
        .sec-matrices { height: 24vh; display: flex; justify-content: center; align-items: center; gap: 5px; background: #fafafa; border-bottom: 1px solid #ddd; padding: 2px; margin-top: 2px; }
        .u-t { display: flex; flex-direction: column; align-items: center; scale: 0.82; }
        .u-l { font-weight: bold; font-size: 13px; color: var(--p); }
        .b-k { display: flex; align-items: center; padding: 2px; border-left: 3px solid var(--p); border-right: 3px solid var(--p); border-radius: 10px / 8px; background: #fff; }
        .det-style { border-radius: 0 !important; border-width: 4px !important; }
        .g-d { display: grid; gap: 1px; }
        .c-l { width: 32px; height: 26px; text-align: center; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; font-weight: bold; outline: none; }
        .c-l.at { background: var(--ac) !important; border: 2px solid var(--a); }
        .c-l.ro { background: #f0f0f0; color: #999; }
        .dim-btn { background: var(--p); color: white; border-radius: 4px; padding: 1px 5px; font-size: 10px; cursor: pointer; margin: 1px; font-weight: bold; }

        /* Ø§Ù„Ù‚Ø³Ù… 2: Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ù…Ø¶ØºÙˆØ·Ø© (24% Ù…Ù† Ø§Ù„Ø§Ø±ØªÙØ§Ø¹) */
        .sec-numpad { height: 24vh; display: grid; grid-template-columns: repeat(4, 1fr); gap: 2px; padding: 3px; background: #34495e; }
        .sec-numpad button { border: none; border-radius: 4px; font-size: 16px; font-weight: bold; background: #ecf0f1; cursor: pointer; box-shadow: 0 1px 0 #bdc3c7; }
        .btn-next { background: var(--a) !important; color: white; }

        /* Ø§Ù„Ù‚Ø³Ù… 3: Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø¶ØºÙˆØ·Ø© (16% Ù…Ù† Ø§Ù„Ø§Ø±ØªÙØ§Ø¹) */
        .sec-ops { height: 16vh; display: grid; grid-template-columns: repeat(4, 1fr); gap: 2px; padding: 3px; background: #ebf0f1; }
        .o-b { border: none; border-radius: 4px; font-size: 9px; font-weight: bold; background: var(--p); color: white; cursor: pointer; }

        /* Ø§Ù„Ù‚Ø³Ù… 4: Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø£ØµØ¨Ø­Øª Ø£ÙˆØ³Ø¹ (32% Ù…Ù† Ø§Ù„Ø§Ø±ØªÙØ§Ø¹) */
        .sec-res { height: 32vh; padding: 5px; overflow-y: auto; background: #fff; border-top: 1px solid var(--a); text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center; padding-bottom: 35px; }
        .res-row { display: flex; align-items: center; justify-content: center; gap: 5px; width: 100%; }
        .res-row .grid { display: grid; gap: 2px; }
        .res-row .c-l { width: var(--cell-w, 35px); height: 28px; font-size: 14px; border: 1px solid #ccc; background: #fff; white-space: nowrap; padding: 0 2px; }
        
        .f-c { display: flex; flex-direction: column; align-items: center; font-size: 14px; font-weight: bold; }
        .f-n { border-bottom: 1.5px solid #000; padding: 0 3px; }

        /* Ø§Ù„Ù…Ø§Ø±ÙƒÙˆÙŠ Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„Ø«Ø§Ø¨Øª (4% ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹) */
        .m-wrap { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--gold); border-top: 1px solid #000; height: 32px; display: flex; align-items: center; z-index: 2000; }
        .m-wrap marquee { color: #000; font-size: 13px; font-weight: bold; line-height: 32px; text-shadow: 1px 1px 1px rgba(142, 68, 173, 0.2); }
        .wa-icon { vertical-align: middle; width: 16px; margin: 0 4px; }
        
        #pwa-btn { display: none; position: fixed; top: 2px; left: 2px; z-index: 2100; background: var(--s); color: white; border: none; padding: 3px 8px; border-radius: 10px; font-size: 9px; font-weight: bold; }
    </style>
</head>
<body>

    <button id="pwa-btn">ØªØ«Ø¨ÙŠØª ğŸ“¥</button>

    <div class="sec-matrices">
        <div id="_preX" style="display:none; margin-top:15px;"><div class="f-c"><span class="f-n">Ù¡</span><span>Ù¢</span></div></div>
        <div class="u-t">
            <div style="display:flex;"><div class="dim-btn" onclick="_fH(7,'A','r')">ØµÙ</div><div class="dim-btn" onclick="_fH(7,'A','c')">Ø¹Ù…ÙˆØ¯</div></div>
            <span class="u-l" id="_lblA">Ø£</span><div class="b-k" id="_brkA"><div id="_grA" class="g-d"></div></div>
        </div>
        <div id="_uSys" style="display:none; align-items:center;"><div style="font-size:16px; font-weight:bold; color:var(--w)">Ã—</div><div class="u-t"><span class="u-l">Ø³</span><div class="b-k"><div id="_grX" class="g-d"></div></div></div><div style="font-size:16px; font-weight:bold; color:var(--w)">=</div></div>
        <div class="u-t">
            <div style="display:flex;"><div class="dim-btn" onclick="_fH(7,'B','r')">ØµÙ</div><div class="dim-btn" onclick="_fH(7,'B','c')">Ø¹Ù…ÙˆØ¯</div></div>
            <span class="u-l">Ø¨</span><div class="b-k" id="_brkB"><div id="_grB" class="g-d"></div></div>
        </div>
    </div>

    <div class="sec-numpad">
        <button onclick="_fH(3,'7')">Ù§</button><button onclick="_fH(3,'8')">Ù¨</button><button onclick="_fH(3,'9')">Ù©</button><button style="background:var(--w);color:white" onclick="_fH(5)">Ù…Ø³Ø­</button>
        <button onclick="_fH(3,'4')">Ù¤</button><button onclick="_fH(3,'5')">Ù¥</button><button onclick="_fH(3,'6')">Ù¦</button><button onclick="_fH(3,'back')">âŒ«</button>
        <button onclick="_fH(3,'1')">Ù¡</button><button onclick="_fH(3,'2')">Ù¢</button><button onclick="_fH(3,'3')">Ù£</button><button class="btn-next" onclick="_fH(4)">Ø§Ù„ØªØ§Ù„ÙŠ</button>
        <button onclick="_fH(3,'0')">Ù </button><button onclick="_fH(3,'-')">Ù€</button><button onclick="_fH(3,'.')">Ù«</button><button style="background:#e74c3c;color:white" onclick="location.reload()">Ø¥Ø¹Ø§Ø¯Ø©</button>
    </div>

    <div class="sec-ops">
        <button class="o-b" onclick="_oK(1)">Ø£ + Ø¨</button><button class="o-b" onclick="_oK(2)">Ø£ - Ø¨</button><button class="o-b" onclick="_oK(3)">Ø£ Ã— Ø¨</button><button class="o-b" onclick="_oK(4)">Ù…Ø­Ø¯Ø¯ Ø£</button>
        <button class="o-b" onclick="_oK(5)">Ù…Ø­Ø¯Ø¯ Ø¨</button><button class="o-b" onclick="_oK(6)">Ù…Ø¹ÙƒÙˆØ³ Ø£</button><button class="o-b" onclick="_oK(7)">Ù…Ø¹ÙƒÙˆØ³ Ø¨</button><button class="o-b" onclick="_oK(8)">Ø£ ^ Ù†</button>
        <button class="o-b" style="background:var(--w)" onclick="_oK(9)">AX=B</button><button class="o-b" style="background:var(--s)" onclick="_oK(10)">Ø§Ù„Ù…Ø³Ø§Ø­Ø©</button><button class="o-b" style="background:var(--random)" onclick="_oK(11)">ØªÙÙƒÙŠÙƒ</button><button class="o-b" style="background:#e74c3c" onclick="_oK(12)">Ø¹Ø´ÙˆØ§Ø¦ÙŠ</button>
    </div>

    <div class="sec-res" id="res"></div>

    <div class="m-wrap">
        <marquee direction="right" scrollamount="5">
            <a href="https://wa.me/201552402912" style="text-decoration:none; color:#000;">
                Ù…Ø­Ù…ÙˆØ¯ Ø¹Ø§Ø¯Ù„ ØµØ§Ù„Ø­  &nbsp;&nbsp;  Ø±ÙŠØ§Ø¶ÙŠØ§Øª ØªÙØ§Ø¹Ù„ÙŠØ©  &nbsp;&nbsp;  <img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" class="wa-icon"> Ù…Ø±Ø§Ø³Ù„ØªÙŠ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ &nbsp;&nbsp; Ù…Ø­Ù…ÙˆØ¯ Ø¹Ø§Ø¯Ù„ ØµØ§Ù„Ø­
            </a>
        </marquee>
    </div>

<script>
    (function(){
        let _ac = null, _d = {A:{r:2,c:2},B:{r:2,c:2},X:{r:2,c:1}}, _isP=false;
        const _ta = n => String(n).replace(/\d/g, d => "Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©"[d]).replace("-", "Ù€"), _te = s => s.replace(/[Ù -Ù©]/g, d => "Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(d)).replace("Ù€", "-");

        window._fH = (n,a,b,c) => {
            if(n===7){ _d[a][b] = _d[a][b] === 3 ? 1 : _d[a][b] + 1; _rG(a); _rs(); }
            if(n===3){ if(!_ac)return; if(_isP){ _ac.value=_ta(a); _isP=false; return; } let v=_ac.value; if(a==='back') _ac.value=v.length>1?v.slice(0,-1):"Ù "; else if(a==='-') _ac.value=v.includes('Ù€')?_ac.value.replace('Ù€',''):'Ù€'+(_ac.value==="Ù "?"":_ac.value); else _ac.value=(_ac.value==="Ù "?_ta(a):_ac.value+_ta(a)); }
            if(n===4){ let l=Array.from(document.querySelectorAll('.c-l:not(.ro)')); let i=l.indexOf(_ac); if(i<l.length-1)_sA(l[i+1]); }
            if(n===5){ if(_ac)_ac.value="Ù "; }
        };
        const _rG = i => { const g=document.getElementById('_gr'+i); if(!g)return; g.style.gridTemplateColumns=`repeat(${_d[i].c},32px)`; g.innerHTML=''; for(let k=0;k<_d[i].r*_d[i].c;k++) g.innerHTML+='<input class="c-l" type="text" value="Ù " readonly onclick="_sA(this)">'; };
        window._sA = e => { if(e.classList.contains('ro'))return; document.querySelectorAll('.c-l').forEach(c=>c.classList.remove('at')); _ac=e; _ac.classList.add('at'); };

        window._oK = n => {
            let a=_gM('A'), b=_gM('B');
            if(n===12) { let isT=document.getElementById('_lblA').innerText.includes("Ù…Ø³Ø§Ø­Ø©"); document.querySelectorAll('.c-l:not(.ro)').forEach((i, idx) => { if(isT && idx % 3 === 0) return; i.value=_ta(Math.floor(Math.random()*19)-9); }); }
            else if(n===8) { document.getElementById('res').innerHTML='<b>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£Ø³ Ù†:</b><br><input class="c-l at" style="width:50px" id="_powV" readonly onclick="_sA(this)" value="Ù¢"><button class="o-b" onclick="_eP()" style="width:60px;margin-right:5px;background:var(--a);padding:3px">Ø§Ø­Ø³Ø¨</button>'; _ac=document.getElementById('_powV'); _ac.classList.add('at'); _isP=true; }
            else if(n===9) { document.getElementById('res').innerHTML='<b>Ø§Ù„Ù…Ø¬Ø§Ù‡ÙŠÙ„:</b><br><button class="o-b" style="width:60px;background:var(--a)" onclick="_setS(2)">Ù¢ (Ø³ØŒ Øµ)</button> <button class="o-b" style="width:60px;background:var(--a)" onclick="_setS(3)">Ù£ (Ø³ØŒØµØŒØ¹)</button>'; }
            else if(n===10) { _rs(); document.getElementById('_uB').style.display='none'; document.getElementById('_preX').style.display='flex'; _d.A={r:3,c:3}; _rG('A'); document.getElementById('_brkA').classList.add('det-style'); document.getElementById('_lblA').innerText="Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø«Ù„Ø«"; let cl=document.querySelectorAll('#_grA input'); for(let i=0;i<3;i++){cl[i*3].value="Ù¡"; cl[i*3].classList.add('ro');} document.getElementById('res').innerHTML='<button class="o-b" style="background:var(--s);padding:5px 15px" onclick="_eT()">Ø§Ø­Ø³Ø¨</button>'; }
            else if(n===1||n===2) { if(_d.A.r!==_d.B.r||_d.A.c!==_d.B.c)return; _sR(a.map((r,i)=>r.map((v,j)=>n===1?v+b[i][j]:v-b[i][j])), n===1?"Ø£ + Ø¨":"Ø£ - Ø¨"); }
            else if(n===3) { if(a[0].length!==b.length)return; _sR(_mu(a,b),"Ø£ Ã— Ø¨"); }
            else if(n===4||n===5) { let r=_adD(n===4?a:b); document.getElementById('res').innerHTML=`<b>Ù…Ø­Ø¯Ø¯ = ${_ta(r.det)}</b>`; }
            else if(n===6||n===7) { let r=_adD(n===6?a:b); if(r.det===0)return; _sR(r.adj,"Ù…Ø¹ÙƒÙˆØ³ Ø§Ù„Ù…ØµÙÙˆÙØ©",r.det); }
            else if(n===11) { if(a.length!==a[0].length)return; let at=_tp(a), s=a.map((r,i)=>r.map((v,j)=>(v+at[i][j])/2)), sk=a.map((r,i)=>r.map((v,j)=>(v-at[i][j])/2)); _sR(s,"Ø§Ù„ØªÙÙƒÙŠÙƒ",null," + ",sk); }
        };

        window._setS = n => { _d.A={r:n,c:n}; _d.B={r:n,c:1}; _d.X={r:n,c:1}; _rG('A'); _rG('B'); document.getElementById('_uSys').style.display='flex'; const gx=document.getElementById('_grX'), ux=n===2?['Ø³','Øµ']:['Ø³','Øµ','Ø¹']; gx.style.gridTemplateColumns='32px'; gx.innerHTML=ux.map(u=>`<input class="c-l ro" type="text" value="${u}" readonly>`).join(''); document.getElementById('res').innerHTML='<button class="o-b" style="padding:5px 15px;background:var(--w)" onclick="_eS()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø­Ù„</button>'; };
        window._eS = () => { let _a=_gM('A'), _b=_gM('B'), _r=_adD(_a); if(_r.det===0)return; let _ajB=_mu(_r.adj,_b), ux=_a.length===2?['Ø³','Øµ']:['Ø³','Øµ','Ø¹']; let h=`<div class="res-row"><div class="b-k"><div class="grid" style="grid-template-columns:repeat(1,32px)">${ux.map(u=>`<input class="c-l ro" type="text" value="${u}" readonly>`).join('')}</div></div><span>=</span>`+(_r.det===1?_rS(_ajB):`<div class="f-c"><span class="f-n">Ù¡</span><span>${_ta(_r.det)}</span></div>`+_rS(_ajB))+`</div>`; document.getElementById('res').innerHTML=h; };
        window._eP = () => { let n=parseInt(_te(document.getElementById('_powV').value))||1, m=_gM('A'); if(_d.A.r!==_d.A.c)return; let r=m; for(let i=1;i<n;i++) r=_mu(r,m); _sR(r,`Ø£ ^ ${_ta(n)}`); };
        window._eT = () => { let m=_gM('A'), d=(m[0][0]*(m[1][1]*m[2][2]-m[1][2]*m[2][1]))-(m[0][1]*(m[1][0]*m[2][2]-m[1][2]*m[2][0]))+(m[0][2]*(m[1][0]*m[2][1]-m[1][1]*m[2][0])); document.getElementById('res').innerHTML=`<b>Ø§Ù„Ù…Ø³Ø§Ø­Ø© = ${_ta(Math.abs(d)/2)} ÙˆØ­Ø¯Ø© Ù…Ø±Ø¨Ø¹Ø©</b>`; };
        window._rs = () => { document.getElementById('_uSys').style.display='none'; document.getElementById('_preX').style.display='none'; document.getElementById('_uB').style.display='flex'; document.getElementById('_brkA').classList.remove('det-style'); document.getElementById('_lblA').innerText="Ø£"; document.getElementById('res').innerHTML=''; };
        const _gM = i => { let cl=document.querySelectorAll(`#_gr${i} input`), r=_d[i].r, c=_d[i].c, m=[]; for(let j=0; j<r; j++){ m[j]=[]; for(let k=0; k<c; k++) m[j][k]=parseFloat(_te(cl[j*c+k].value))||0; } return m; };
        const _mu = (m1,m2) => { let r=Array(m1.length).fill(0).map(()=>Array(m2[0].length).fill(0)); for(let i=0; i<m1.length; i++)for(let j=0; j<m2[0].length; j++)for(let k=0; k<m1[0].length; k++)r[i][j]+=m1[i][k]*m2[k][j]; return r; };
        const _tp = a => a[0].map((_,c)=>a.map(r=>r[c]));
        const _adD = m => { let n=m.length, d=(n===1)?m[0][0]:(n===2)?(m[0][0]*m[1][1]-m[0][1]*m[1][0]):(m[0][0]*(m[1][1]*m[2][2]-m[1][2]*m[2][1])-m[0][1]*(m[1][0]*m[2][2]-m[1][2]*m[2][0])+m[0][2]*(m[1][0]*m[2][1]-m[1][1]*m[2][0])), aj = (n===1)?[[1]]:(n===2)?[[m[1][1],-m[0][1]],[-m[1][0],m[0][0]]]:[[(m[1][1]*m[2][2]-m[1][2]*m[2][1]),-(m[0][1]*m[2][2]-m[0][2]*m[2][1]),(m[0][1]*m[1][2]-m[0][2]*m[1][1])],[-(m[1][0]*m[2][2]-m[1][2]*m[2][0]),(m[0][0]*m[2][2]-m[0][2]*m[2][0]),-(m[0][0]*m[1][2]-m[0][2]*m[1][0])],[(m[1][0]*m[2][1]-m[1][1]*m[2][0]),-(m[0][0]*m[2][1]-m[0][1]*m[2][0]),(m[0][0]*m[1][1]-m[0][1]*m[1][0])]]; return {adj:aj, det:d}; };
        
        const _rS = m => { 
            let maxLen = 0;
            m.forEach(r=>r.forEach(v=>{ let s=_ta(Number.isInteger(v)?v:v.toFixed(1)); if(s.length > maxLen) maxLen = s.length; }));
            let cellW = Math.max(34, (maxLen * 8.5) + 8); 
            let h=`<div class="b-k" style="--cell-w:${cellW}px"><div class="grid" style="grid-template-columns:repeat(${m[0].length}, var(--cell-w))">`; 
            m.forEach(r=>r.forEach(v=>h+=`<input class="c-l ro" type="text" value="${_ta(Number.isInteger(v)?v:v.toFixed(1))}" readonly>`)); return h+'</div></div>'; 
        };
        const _sR = (m,t,dt=null,sep="",m2=null) => { let h=`<b>${t}</b><div class="res-row">`+(dt && dt!==1?`<div class="f-c"><span class="f-n">Ù¡</span><span>${_ta(dt)}</span></div>`:"")+_rS(m)+(sep?`<span>${sep}</span>`:"")+(m2?_rS(m2):"")+'</div>'; document.getElementById('res').innerHTML=h; };
        _rG('A'); _rG('B');
    })();
</script>
</body>
</html>
